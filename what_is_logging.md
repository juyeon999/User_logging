# 이벤트 로그 관련 공부

아래 변성윤님의 자료를 정리하며 공부한 자료입니다. 모든 자료의 출처는 다음과 같습니다.
- [데이터 로그 설계, 데이터 로깅, 이벤트 로그 설계, 데이터 QA의 모든 것](https://zzsza.github.io/data/2021/06/13/data-event-log-definition/)
    
---
## 데이터 로깅이란?
- 데이터는 이제 우리의 삶 어디에서나 볼 수 있음
    - 매일 사용하는 핸드폰, 카카오톡, 쿠팡 등 각각의 앱을 사용할 때마다 우리가 어떤 행동을 하는지 데이터가 남음
    - 이런 데이터를 **사용자 로그 데이터, 이벤트 로그 데이터** 등으로 부름
- 유저 로그 데이터의 예시
    - 유저 로그라고 지칭하면 사용자 행동 데이터를 의미함
    - 서비스에 반드시 필요한 내용은 아니고, 더 좋은 제품을 만들기 위해 또는 데이터 분석 시 필요한 데이터를 의미함
    - 앱이나 웹에서 유저가 어떤 행동을 하는지 나타내는 데이터
    - UX와 관련해서 인터렉션이 이루어지는 관점에서 발생하는 데이터를 뜻함
    - 예를 들어, Click, View, 스와이프 등
- 유저 로그 데이터의 예
    - user_id가 1인 user가 특정 웹 사이트에 로그인했다
    - user_id가 1인 user가 제품 구매 페이지(URL)에 접근했다
    - user_id가 1인 user가 제품 구매 페이지에서 특정(Component) 버튼을 클릭했다
    - user_id가 1인 user가 제품 구매 요청(Request)을 했다
    - user_id가 1인 user가 특정 웹 사이트에 로그아웃 했다
- **특정 상황을 이벤트로 정의하고, 이벤트의 파라미터가 어떤 것으로 저장해야 하는지** 등의 내용을 정의(설계)하는 행동을 **데이터 로깅, 이벤트 로그 설계** 등으로 부름
- 이 글은 사용자 행동 데이터(유저 행동 로그)를 로깅하는 관점에 대해 집중함

## 데이터 로그 설계를 위한 기본 상식
- 1) 데이터가 **어디에서** 발생하는지 확인해야 함 (Source)
    - 대표적으로 서버 / 앱 / 웹
    - 서버: 특정 API의 Request 정보를 기록함. 클라이언트나 웹에서 API 호출할 경우 저장함.
    - 앱 (클라이언트): IOS/AOS에서 만든 앱의 기록. 화면에서 유저가 어떤 화면에 진입했는지, 어떤 버튼을 클릭했는지 등을 기록함
    - 웹 (클라이언트): 웹 브라우저의 기록. 어떤 웹 페이지에 진입했고 어떤 버튼을 클릭했는지 등을 기록함
      - 유저가 앱/웹을 어떻게 사용하는지 궁금한 경우엔 앱/웹에 남기는 것이 좋고, 서버는 API의 요청을 남김
      - 두 가지는 상호 보완적이고, 특정 상황은 한 쪽에서 쌓기로 합의하는 것도 좋음
- 2) 구글 애널리틱스(GA, Google Analytics)
  - 구글 애널리틱스는 구글에서 제공하는 웹 분석 서비스
  - 웹사이트의 데이터를 수집, 분석해서 온라인 비즈니스 성과를 측정하고 개선할 때 사용하는 도구
  - 구글 애널리틱스에 쌓인 데이터를 구글 클라우드 빅쿼리로 추출할 수 있음
- 3) 구글 파이어베이스(Google Firebase)
  - 구글 파이어베이스는 구글에서 만든 앱, 웹 애플리케이션 개발 플랫폼
  - 파이어베이스를 사용해 앱을 만드는 경우, 빠른 시간 내에 비즈니스 로직을 구현해 앱을 만들 수 있음

## 이벤트 파라미터, 유저 프로퍼티 
- 1) 이벤트
  - 예를 들어 회원 가입 버튼(Component)을 클릭한 경우
    - event: Click
    - 이벤트의 파라미터로 "어떤 버튼"을 클릭했는지 기록, 예: component_name: sign_up
  - 이벤트의 구체적인 세부 정보는 파라미터에 저장함 (key: value 형태)
- 2) 유저
  - 유저가 특정 이벤트를 할 당시의 정보를 유저 프로퍼티로 저장함
  - 예를 들어, 이커머스 앱에 접속한 이벤트에 그 유저가 여태까지 제품을 구매한 횟수와 총 누적 금액 등이 유저 프로퍼티로 저장되어 있으면 구매 금액별 분석을 할 수 있음.
  - 이러한 데이터은 Database에 저장될 수도 있는데, 특정 시점의 테이블에 저장된 데이터를 추출한 후, join해서 사용할 수도 있음. 그러나 분석의 용이성을 위해서 유저 프로퍼티로 저장할 수도 있음.
  - 단, 유저의 DB에서 확ㅇ니할 수 있는 정보 중 정말 의미가 있다고 판단되는 것만 유저 프로퍼티로 넣는 것이 좋음. 혹은 사용자에 따라 수시로 변할 수 있는 옵션이거나 서버에서 모르는 경우 로깅
  - AB Test 같은 실험할 때, 실험군과 대조군이 유저별로 계속 고정되어야 하기에 이런 정보를 유저 프로퍼티로 넣음

## 데이터가 저장되는 형태
- 저장되는 형태는 DB냐 텍스트 파일로 저장되느냐 크게 2가지로 구분할 수 있음
- DB: 데이터베이스로, RDB와 NoSQL 등이 있음. 회원 정보, 주문 정보 등의 데이터는 로그 형태보다 DB에 저장함
- 텍스트 파일: 하나의 파일에 데이터를 저장함
  - 텍스트 파일로 저장된 경우 데이터 분석을 위해 데이터 웨어하우스로 옮기는 파이프라인이 필요할 수 있음

## 이벤트 로그 설계하는 방법
- 이벤트 로그는 총 3가지 Element가 존재함
  - 1) 발생한 이벤트가 무엇인지(Event)
    - Click, View, Swipe 등
  - 2) 어느 지섬에 실행되는지(Trigger)
    - 특정 Component를 클릭하는 시점
    - 특정 화면이 보이는 경우
    - 스와이프로 다음 화면에 넘어간 경우
    - 서버의 Request하는 시점
    - 서버의 Request 후 Response가 되는 시점(이런 경우엔 Response에 있는 데이터가 알고 싶은 경우)
    - 실행된 시간도 같이 기록함
  - 3) 어떤 상태를 가지는지(State)
    - 어떤 User인지, 어떤 화면인지, 어떤 버튼을 클릭한 상태인지?
    - 이벤트 상태와 관련된 정보를 제공함
    - 이벤트 파라미터를 기록함
  
## 개인적인 이벤트 로깅 팁
- 로그는 최대한 자세할수록 좋지만, 우선 순위를 정할 필요가 있음
  - 자주 봐야하는 지표라면 꼭 심는 것이 좋음
  - 모든 것을 로깅하면 좋지만, 저장에 대한 비용 등이 있음.
  - 사용되지 않을 데이터를 저장하기 위해 시간을 쓰는 것은 아깝다.